#!/usr/bin/env ruby
# Programmer: Chris Bunch


$:.unshift File.join(File.dirname(__FILE__), "..", "lib")
require 'appscale_tools'


if __FILE__ == $0
  options = ParseArgs.get_vals_from_args(ARGV, AppScaleTools::UPLOAD_APP_FLAGS,
    AppScaleTools::UPLOAD_APP_USAGE)
  begin
    AppScaleTools.upload_app(options)
  rescue Exception => e
    # first, collect all of the logs that could be useful in debugging
    # why the above Exception was thrown
    CommonFunctions.collect_and_send_logs(options, e)

    # now throw the original exception, since there's no corrective action
    # we can take here
    raise e
  end
end
